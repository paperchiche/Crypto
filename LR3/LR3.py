import math
from typing import List

SUP_TRANS = str.maketrans("0123456789", "⁰¹²³⁴⁵⁶⁷⁸⁹")


def main():
    n = int(input('GF(2ⁿ), n='))
    reducing_polynomial = IRREDUCIBLE_POLYNOMIALS[n]

    print(f'Используем порождающий полином: {polynomial_to_string(reducing_polynomial)}')

    all_field_elements = {x for x in range(1, 2 ** n)}

    found_primitives = []

    for test_pol in range(1, 2 ** n):
        print(f'Проверяем многочлен {polynomial_to_string(test_pol)}:')

        all_powers = get_all_polynomial_powers(test_pol, n, reducing_polynomial)

        print(f'\tПорождает элементы: {all_powers}')

        if all_powers == all_field_elements:
            print('\tПорождает все элементы поля => примитивный ✔️')
            found_primitives.append(polynomial_to_string(test_pol))
        else:
            print('\tНе порождает все элементы поля => не примитивный ❌')

    print(f'Итоговый список примитивных полиномов в GF({2 ** n}):')
    for str_pol in found_primitives:
        print(f'\t{str_pol}')


# Возвести полином во все степени в GF(2^n)
# field_elements - заранее сгенерированные все элементы поля GF(2^n) - множество чисел {1, ..., 2^n - 1}
def get_all_polynomial_powers(polynomial: int, n: int, reducing_polynomial: int) -> set[int]:
    field_size = 2 ** n

    powers = set()
    powers.add(polynomial)
    current_polynomial_power = polynomial
    for _ in range(field_size - 1):
        current_polynomial_power = multiply_polynomials(current_polynomial_power, polynomial, reducing_polynomial)
        powers.add(current_polynomial_power)

    return powers


def get_polynomial_degree(pol: int) -> int:
    if pol > 0:
        return int(math.log2(pol))
    else:
        return -1


def add_polynomials(pol1: int, pol2: int) -> int:
    return pol1 ^ pol2


def polynomial_power(pol: int, power: int, reducing_polynomial: int) -> int:
    if power == 0:
        return 1

    result = pol
    for i in range(power - 1):
        result = multiply_polynomials(result, pol, reducing_polynomial)

    return result


def multiply_polynomials(pol1: int, pol2: int, reducing_polynomial: int) -> int:
    pol1_deg = get_polynomial_degree(pol1)
    pol2_deg = get_polynomial_degree(pol2)
    max_result_deg = pol1_deg + pol2_deg
    result_powers = [False for _ in range(max_result_deg + 1)]

    bin_pol1 = polynomial_to_bin_string(pol1)
    bin_pol2 = polynomial_to_bin_string(pol2)

    for pol1_bit_idx in range(pol1_deg + 1):
        for pol2_bit_idx in range(pol2_deg + 1):
            if (bin_pol1[pol1_bit_idx] == '1') and (bin_pol2[pol2_bit_idx] == '1'):
                x_1_pow = pol1_deg - pol1_bit_idx
                x_2_pow = pol2_deg - pol2_bit_idx
                result_powers[x_1_pow + x_2_pow] = not result_powers[x_1_pow + x_2_pow]

    result_bin = ''
    for x in reversed(result_powers):
        result_bin += '1' if x else '0'

    result = bin_string_to_polynomial(result_bin)

    # Reduce the result % the reducing polynomial
    while get_polynomial_degree(result) >= get_polynomial_degree(reducing_polynomial):
        shift = get_polynomial_degree(result) - get_polynomial_degree(reducing_polynomial)
        result ^= reducing_polynomial << shift

    return result


def divide_polynomials(dividend: int, divisor: int, n: int, gen_polynomial: int) -> tuple[int, int]:
    if divisor == 0:
        raise ValueError("Division by zero")

    quotient = 0
    remainder = dividend
    divisor_degree = get_polynomial_degree(divisor)

    while get_polynomial_degree(remainder) >= divisor_degree:
        dividend_degree = get_polynomial_degree(remainder)
        shift = dividend_degree - divisor_degree
        quotient_term = 1 << shift
        quotient ^= quotient_term
        remainder ^= multiply_polynomials(quotient_term, divisor, gen_polynomial)

    return quotient, remainder


def polynomial_to_bin_string(pol: int) -> str:
    return bin(pol)[2:]


def bin_string_to_polynomial(bin_str: str) -> int:
    return int(bin_str, 2)


def polynomial_to_string(pol: int):
    if pol == 0:
        return '0'

    pol_bin = bin(pol)[2:]
    pol_deg = get_polynomial_degree(pol)
    sum_elements = []

    for i in range(pol_deg + 1):
        if pol_bin[i] == '1':
            if i == pol_deg:
                sum_elements.append('1')
            elif i == pol_deg - 1:
                sum_elements.append('x')
            else:
                sum_elements.append(f'x{str(pol_deg - i).translate(SUP_TRANS)}')

    return ' + '.join(sum_elements)


# Неприводимые многочлены. Индекс в списке соответствует степени многочлена.
IRREDUCIBLE_POLYNOMIALS = [
    None,
    3,
    7,
    11,
    19,
    37,
    67,
    131,
    285,
    529,
    1033,
    2053,
    4179,
    8219,
    16427,
    32771,
    65581,
    131081,
    262183,
    524327,
    1048585,
    2097157,
    4194307,
    8388641,
    16777243,
    33554441,
    67108935,
    134217767,
    268435465,
    536870917,
    1073741907,
    2147483657,
    4294967471,
    8589934675,
    17179869415,
    34359738373,
    68719476855,
    137438953535,
    274877907043,
    549755813905,
    1099511627833,
    2199023255561,
    4398046511167,
    8796093022297,
    17592186044517,
    35184372088859,
    70368744177967,
    140737488355361,
    281474976710839,
    562949953421425,
    1125899906842653,
    2251799813685323,
    4503599627370505,
    9007199254741063,
    18014398509482109,
    36028797018964039,
    72057594037928085,
    144115188075855917,
    288230376151711843,
    576460752303423611,
    1152921504606846979,
    2305843009213693991,
    4611686018427388009,
    9223372036854775811,
    18446744073709551643,
    36893488147419103259,
    73786976294838206829,
    147573952589676412967,
    295147905179352826019,
    590295810358705651813,
    1180591620717411303467,
    2361183241434822606891,
    4722366482869645213791,
    9444732965739290427421,
    18889465931478580854937,
    37778931862957161709643,
    75557863725914323419189,
    151115727451828646838373,
    302231454903657293676679,
    604462909807314587353117,
    1208925819614629174706351,
    2417851639229258349412369,
    4835703278458516698825171,
    9671406556917033397649557,
    19342813113834066795299243,
    38685626227668133590597895,
    77371252455336267181195365,
    154742504910672534362390691,
    309485009821345068724781371,
    618970019642690137449562217,
    1237940039285380274899124269,
    2475880078570760549798248685,
    4951760157141521099596496997,
    9903520314283042199192993797,
    19807040628566084398385987683,
    39614081257132168796771975287,
    79228162514264337593543950557,
    158456325028528675187087900737,
    316912650057057350374175801503,
    633825300114114700748351602865,
    1267650600228229401496703205765,
    2535301200456458802993406410947,
    5070602400912917605986812821609,
    10141204801825835211973625643197,
    20282409603651670423947251286909,
    40564819207303340847894502572151,
    81129638414606681695789005144163,
    162259276829213363391578010288303,
    324518553658426726783156020578047,
    649037107316853453566312041152565,
    1298074214633706907132624082305107,
    2596148429267413814265248164610197,
    5192296858534827628530496329220431,
    10384593717069655257060992658440237,
    20769187434139310514121985316880845,
    41538374868278621028243970633760943,
    83076749736557242056487941267521637,
    166153499473114484112975882535043111,
    332306998946228968225951765070086245,
    664613997892457936451903530140172545,
    1329227995784915872903807060280344807,
    2658455991569831745807614120560689443,
    5316911983139663491615228241121378375,
    10633823966279326983230456482242756613,
    21267647932558653966460912964485513441,
    42535295865117307932921825928971026607,
    85070591730234615865843651857942053013,
    170141183460469231731687303715884105731,
    340282366920938463463374607431768211591,
    680564733841876926926749214863536422945,
    1361129467683753853853498429727072845833,
    2722258935367507707706996859454145691891,
    5444517870735015415413993718908291383421,
    10889035741470030830827987437816582766703,
    21778071482940061661655974875633165533347,
    43556142965880123323311949751266331066457,
    87112285931760246646623899502532662133005,
    174224571863520493293247799005065324265789,
    348449143727040986586495598010130648531309,
    696898287454081973172991196020261297062063,
    1393796574908163946345982392040522594124051,
    2787593149816327892691964784081045188247979,
    5575186299632655785383929568162090376495347,
    11150372599265311570767859136324180752990253,
    22300745198530623141535718272648361505980565,
    44601490397061246283071436545296723011960931,
    89202980794122492566142873090593446023921709,
    178405961588244985132285746181186892047843391,
    356811923176489970264571492362373784095686825,
    713623846352979940529142984724747568191374075,
    1427247692705959881058285969449495136382746807,
    2854495385411919762116571938898990272765493257,
    5708990770823839524233143877797980545530986573,
    11417981541647679048466287755595961091061972995,
    22835963083295358096932575511191922182123946221,
    45671926166590716193865151022383844364247892145,
    91343852333181432387730302044767688728495784489,
    182687704666362864775460604089535377456991567973,
    365375409332725729550921208179070754913983136055,
    730750818665451459101842416358141509827966271611,
    1461501637330902918203684832716283019655932543021,
    2923003274661805836407369665432566039311865086029,
    5846006549323611672814739330865132078623730172305,
    11692013098647223345629478661730264157247460344009,
    23384026197294446691258957323460528314494920688111,
    46768052394588893382517914646921056628989841375835,
    93536104789177786765035829293842113257979682751501,
    187072209578355573530071658587684226515959365500993,
    374144419156711147060143317175368453031918731002293,
    748288838313422294120286634350736906063837462004065,
    1496577676626844588240573268701473812127674924007823,
    2993155353253689176481146537402947624255349848014911,
    5986310706507378352962293074805895248510699696029825,
    11972621413014756705924586149611790497021399392059685,
    23945242826029513411849172299223580994042798784118909,
    47890485652059026823698344598447161988085597568237633,
    95780971304118053647396689196894323976171195136475325,
    191561942608236107294793378393788647952342390272950317,
    383123885216472214589586756787577295904684780545900933,
    766247770432944429179173513575154591809369561091801111,
    1532495540865888858358347027150309183618739122183602541,
    3064991081731777716716694054300618367237478244367204547,
    6129982163463555433433388108601236734474956488734409027,
    12259964326927110866866776217202473468949912977468817809,
    24519928653854221733733552434404946937899825954937635165,
    49039857307708443467467104868809893875799651909875269899,
    98079714615416886934934209737619787751599303819750539677,
    196159429230833773869868419475239575503198607639501078753,
    392318858461667547739736838950479151006397215279002157157,
    784637716923335095479473677900958302012794430558004314213,
    1569275433846670190958947355801916604025588861116008628887,
    3138550867693340381917894711603833208051177722232017256635,
    6277101735386680763835789423207666416102355444464034513245,
    12554203470773361527671578846415332832204710888928069026295,
    25108406941546723055343157692830665664409421777856138051613,
    50216813883093446110686315385661331328818843555712276103351,
    100433627766186892221372630771322662657637687111424552207251,
    200867255532373784442745261542645325315275374222849104413167,
    401734511064747568885490523085290650630550748445698208827251,
    803469022129495137770981046170581301261101496891396417650925,
    1606938044258990275541962092341162602522202993782792835301421,
    3213876088517980551083924184682325205044405987565585670602829,
    6427752177035961102167848369364650410088811975131171341205713,
    12855504354071922204335696738729300820177623950262342682411395,
    25711008708143844408671393477458601640355247900524685364822443,
    51422017416287688817342786954917203280710495801049370729644581,
    102844034832575377634685573909834406561420991602098741459288239,
    205688069665150755269371147819668813122841983204197482918576707,
    411376139330301510538742295639337626245683966408394965837152723,
    822752278660603021077484591278675252491367932816789931674304557,
    1645504557321206042154969182557350504982735865633579863348609653,
    3291009114642412084309938365114701009965471731267159726697218667,
    6582018229284824168619876730229402019930943462534319453394436249,
    13164036458569648337239753460458804039861886925068638906788872293,
    26328072917139296674479506920917608079723773850137277813577744427,
    52656145834278593348959013841835216159447547700274555627155488873,
    105312291668557186697918027683670432318895095400549111254310977675,
    210624583337114373395836055367340864637790190801098222508621955185,
    421249166674228746791672110734681729275580381602196445017243910389,
    842498333348457493583344221469363458551160763204392890034487820533,
    1684996666696914987166688442938726917102321526408785780068975640863,
    3369993333393829974333376885877453834204643052817571560137951281463,
    6739986666787659948666753771754907668409286105635143120275902562597,
    13479973333575319897333507543509815336818572211270286240551805124661,
    26959946667150639794667015087019630673637144422540572481103610249653,
    53919893334301279589334030174039261347274288845081144962207220498797,
    107839786668602559178668060348078522694548577690162289924414440997179,
    215679573337205118357336120696157045389097155380324579848828881993851,
    431359146674410236714672241392314090778194310760649159697657763987771,
    862718293348820473429344482784628181556388621521298319395315527975527,
    1725436586697640946858688965569256363112777243042596638790631055950273,
    3450873173395281893717377931138512726225554486085193277581262111899797,
    6901746346790563787434755862277025452451108972170386555162524223799959,
    13803492693581127574869511724554050904902217944340773110325048447598781,
    27606985387162255149739023449108101809804435888681546220650096895197643,
    55213970774324510299478046898216203619608871777363092441300193790394829,
    110427941548649020598956093796432407239217743554726184882600387580788769,
    220855883097298041197912187592864814478435487109452369765200775161577619,
    441711766194596082395824375185729628956870974218904739530401550323154983,
    883423532389192164791648750371459257913741948437809479060803100646309951,
    1766847064778384329583297500742918515827483896875618958121606201292620073,
    3533694129556768659166595001485837031654967793751237916243212402585239929,
    7067388259113537318333190002971674063309935587502475832486424805170479475,
    14134776518227074636666380005943348126619871175004951664972849610340958499,
    28269553036454149273332760011886696253239742350009903329945699220681916775,
    56539106072908298546665520023773392506479484700019806659891398441363832915,
    113078212145816597093331040047546785012958969400039613319782796882727666905,
    226156424291633194186662080095093570025917938800079226639565593765455331861,
    452312848583266388373324160190187140051835877600158453279131187530910662973,
    904625697166532776746648320380374280103671755200316906558262375061821325459,
    1809251394333065553493296640760748560207343510400633813116524750123642650735,
    3618502788666131106986593281521497120414687020801267626233049500247285301397,
    7237005577332262213973186563042994240829374041602535252466099000494570603377,
    14474011154664524427946373126085988481658748083205070504932198000989141205055,
    28948022309329048855892746252171976963317496166410141009864396001978282410119,
    57896044618658097711785492504343953926634992332820282019728792003956564820013,
    115792089237316195423570985008687907853269984665640564039457584007913129640997,
    231584178474632390847141970017375815706539969331281128078915168015826259280061,
    463168356949264781694283940034751631413079938662562256157830336031652518560337,
    926336713898529563388567880069503262826159877325124512315660672063305037119995,
    1852673427797059126777135760139006525652319754650249024631321344126610074239375,
    3705346855594118253554271520278013051304639509300498049262642688253220148478161,
    7410693711188236507108543040556026102609279018600996098525285376506440296956689,
    14821387422376473014217086081112052205218558037201992197050570753012880593912447,
    29642774844752946028434172162224104410437116074403984394101141506025761187825155,
    59285549689505892056868344324448208820874232148807968788202283012051522375647277,
    118571099379011784113736688648896417641748464297615937576404566024103044751294639,
    237142198758023568227473377297792835283496928595231875152809132048206089502589257,
    474284397516047136454946754595585670566993857190463750305618264096412179005178759,
    948568795032094272909893509191171341133987714380927500611236528192824358010355907,
    1897137590064188545819787018382342682267975428761855001222473056385648716020711773,
    3794275180128377091639574036764685364535950857523710002444946112771297432041423135,
    7588550360256754183279148073529370729071901715047420004889892225542594864082846179,
    15177100720513508366558296147058741458143803430094840009779784451085189728165691527,
    30354201441027016733116592294117482916287606860189680019559568902170379456331383143,
    60708402882054033466233184588234965832575213720379360039119137804340758912662765883,
    121416805764108066932466369176469931665150427440758720078238275608681517825325531211,
    242833611528216133864932738352939863330300854881517440156476551217363035650651062455,
    485667223056432267729865476705879726660601709763034880312953102434726071301302124577,
    971334446112864535459730953411759453321203419526069760625906204869452142602604249121,
    1942668892225729070919461906823518906642406839052139521251812409738904285205208498725,
    3885337784451458141838923813647037813284813678104279042503624819477808570410416996883,
    7770675568902916283677847627294075626569627356208558085007249638955617140820833993641,
    15541351137805832567355695254588151253139254712417116170014499277911234281641667985767,
    31082702275611665134711390509176302506278509424834232340028998555822468563283335971169,
    62165404551223330269422781018352605012557018849668464680057997111644937126566671942817,
    124330809102446660538845562036705210025114037699336929360115994223289874253133343883771,
    248661618204893321077691124073410420050228075398673858720231988446579748506266687766629,
    497323236409786642155382248146820840100456150797347717440463976893159497012533375533735,
    994646472819573284310764496293641680200912301594695434880927953786318994025066751066357,
    1989292945639146568621528992587283360401824603189390869761855907572637988050133502132269,
    3978585891278293137243057985174566720803649206378781739523711815145275976100267004264571,
    7957171782556586274486115970349133441607298412757563479047423630290551952200534008529035,
    15914343565113172548972231940698266883214596825515126958094847260581103904401068017058395,
    31828687130226345097944463881396533766429193651030253916189694521162207808802136034116063,
    63657374260452690195888927762793067532858387302060507832379389042324415617604272068231221,
    127314748520905380391777855525586135065716774604121015664758778084648831235208544136463811,
    254629497041810760783555711051172270131433549208242031329517556169297662470417088272924705,
    509258994083621521567111422102344540262867098416484062659035112338595324940834176545849659,
    1018517988167243043134222844204689080525734196832968125318070224677190649881668353091698863,
    2037035976334486086268445688409378161051468393665936250636140449354381299763336706183397505,
    4074071952668972172536891376818756322102936787331872501272280898708762599526673412366795111,
    8148143905337944345073782753637512644205873574663745002544561797417525199053346824733589567,
    16296287810675888690147565507275025288411747149327490005089123594835050398106693649467179463,
    32592575621351777380295131014550050576823494298654980010178247189670100796213387298934358079,
    65185151242703554760590262029100101153646988597309960020356494379340201592426774597868716229,
    130370302485407109521180524058200202307293977194619920040712988758680403184853549195737432203,
    260740604970814219042361048116400404614587954389239840081425977517360806369707098391474864405,
    521481209941628438084722096232800809229175908778479680162851955034721612739414196782949729807,
    1042962419883256876169444192465601618458351817556959360325703910069443225478828393565899456883,
    2085924839766513752338888384931203236916703635113918720651407820138886450957656787131798913315,
    4171849679533027504677776769862406473833407270227837441302815640277772901915313574263597826217,
    8343699359066055009355553539724812947666814540455674882605631280555545803830627148527195653969,
    16687398718132110018711107079449625895333629080911349765211262561111091607661254297054391304331,
    33374797436264220037422214158899251790667258161822699530422525122222183215322508594108782608743,
    66749594872528440074844428317798503581334516323645399060845050244444366430645017188217565216891,
    133499189745056880149688856635597007162669032647290798121690100488888732861290034376435130434487,
    266998379490113760299377713271194014325338065294581596243380200977777465722580068752870260867221,
    533996758980227520598755426542388028650676130589163192486760401955554931445160137505740521734497,
    1067993517960455041197510853084776057301352261178326384973520803911109862890320275011481043468591,
    2135987035920910082395021706169552114602704522356652769947041607822219725780640550022962086936603,
    4271974071841820164790043412339104229205409044713305539894083215644439451561281100045924173873317,
    8543948143683640329580086824678208458410818089426611079788166431288878903122562200091848347747063,
    17087896287367280659160173649356416916821636178853222159576332862577757806245124400183696695492731,
    34175792574734561318320347298712833833643272357706444319152665725155515612490248800367393390985305,
    68351585149469122636640694597425667667286544715412888638305331450311031224980497600734786781970775,
    136703170298938245273281389194851335334573089430825777276610662900622062449960995201469573563941899,
    273406340597876490546562778389702670669146178861651554553221325801244124899921990402939147127881965,
    546812681195752981093125556779405341338292357723303109106442651602488249799843980805878294255764129,
    1093625362391505962186251113558810682676584715446606218212885303204976499599687961611756588511527229,
    2187250724783011924372502227117621365353169430893212436425770606409952999199375923223513177023053935
]

if __name__ == '__main__':
    main()
